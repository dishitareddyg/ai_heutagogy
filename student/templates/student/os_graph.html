<!--
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>OS Knowledge Graph</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="https://cdn.tailwindcss.com"></script>

  <script src="https://d3js.org/d3.v7.min.js"></script>

  <style>
    svg {
      width: 100%;
      height: 70vh;
    }

    text {
      pointer-events: none;
      user-select: none;
    }
  </style>
</head>

<body class="min-h-screen px-4 py-10 flex justify-center
             bg-gradient-to-br from-blue-100 via-sky-50 to-indigo-100">

  <div class="w-full max-w-6xl bg-white rounded-2xl shadow-xl p-8 md:p-10">

    <div class="text-center mb-8">
      <h2 class="text-2xl font-semibold text-gray-800">
        ðŸ§  OS Knowledge Graph
      </h2>
      <p class="text-sm text-gray-600 mt-2">
        Select and explore Operating System topics in any order
      </p>
    </div>

    <div class="rounded-xl border border-gray-200 bg-gray-50 overflow-hidden">
      <svg id="graph"></svg>
    </div>

    <p class="text-center text-xs text-gray-500 mt-6">
      Drag nodes freely â€¢ Independent topics can be learned anytime
    </p>

  </div>

  {{ nodes|json_script:"nodes-data" }}
  {{ links|json_script:"links-data" }}

  <script>
  /* =========================
     LOAD DATA
  ========================= */
  const nodes = JSON.parse(
    document.getElementById("nodes-data").textContent
  );

  const links = JSON.parse(
    document.getElementById("links-data").textContent
  );

  /* =========================
     SVG SETUP
  ========================= */
  const svg = d3.select("#graph");
  const width = svg.node().clientWidth;
  const height = svg.node().clientHeight;

  /* =========================
     GROUP NODES
  ========================= */
  const independentNodes = nodes.filter(d => d.independent);
  const coreNodes = nodes.filter(d => !d.independent);

  /* =========================
     FORCE SIMULATION
  ========================= */
  const simulation = d3.forceSimulation(nodes)

    .force("link",
      d3.forceLink(links)
        .id(d => d.id)
        .distance(140)
        .strength(0.8)
    )

    .force("charge",
      d3.forceManyBody()
        .strength(d => d.independent ? -120 : -300)
    )

    .force("collision",
      d3.forceCollide()
        .radius(55)
        .strength(1)
    )

    .force("coreX",
      d3.forceX(d => d.independent ? width * 0.85 : width * 0.35)
        .strength(0.25)
    )

    .force("coreY",
      d3.forceY(d => {
        if (d.independent) {
          return 120 + independentNodes.indexOf(d) * 90;
        }
        return height / 2;
      }).strength(0.25)
    );

  /* =========================
     LINKS
  ========================= */
  const link = svg.append("g")
    .attr("stroke", "#9ca3af")
    .attr("stroke-dasharray", "5,5")
    .selectAll("line")
    .data(links)
    .enter()
    .append("line");

  /* =========================
     NODES
  ========================= */
  const node = svg.append("g")
    .selectAll(".node")
    .data(nodes)
    .enter()
    .append("g")
    .call(
      d3.drag()
        .on("start", dragstarted)
        .on("drag", dragged)
        .on("end", dragended)
    );

  node.append("circle")
    .attr("r", 22)
    .attr("fill", d => d.independent ? "#22c55e" : "#f59e0b")
    .attr("stroke", "#fff")
    .attr("stroke-width", 2);

  node.append("text")
    .text(d => d.id)
    .attr("y", 38)
    .attr("text-anchor", "middle")
    .attr("font-size", "12px")
    .attr("fill", "#374151");

  /* =========================
     TICK UPDATE
  ========================= */
  simulation.on("tick", () => {

    link
      .attr("x1", d => d.source.x)
      .attr("y1", d => d.source.y)
      .attr("x2", d => d.target.x)
      .attr("y2", d => d.target.y);

    node
      .attr("transform", d => `translate(${d.x}, ${d.y})`);
  });

  /* =========================
     DRAG
  ========================= */
  function dragstarted(event, d) {
    if (!event.active) simulation.alphaTarget(0.3).restart();
    d.fx = d.x;
    d.fy = d.y;
  }

  function dragged(event, d) {
    d.fx = event.x;
    d.fy = event.y;
  }

  function dragended(event, d) {
    if (!event.active) simulation.alphaTarget(0);
    d.fx = null;
    d.fy = null;
  }
  </script>

</body>
</html>
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>OS Knowledge Graph - Heutagogy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Space Grotesk', -apple-system, BlinkMacSystemFont, sans-serif;
      min-height: 100vh;
      background: #0a0118;
      position: relative;
      overflow-x: hidden;
      padding: 20px;
    }
    
    /* Animated background */
    body::before {
      content: '';
      position: fixed;
      width: 200%;
      height: 200%;
      top: -50%;
      left: -50%;
      background: 
        radial-gradient(circle at 20% 50%, rgba(147, 51, 234, 0.25) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(236, 72, 153, 0.25) 0%, transparent 50%),
        radial-gradient(circle at 40% 20%, rgba(59, 130, 246, 0.25) 0%, transparent 50%);
      animation: drift 20s ease-in-out infinite;
      z-index: 0;
    }
    
    @keyframes drift {
      0%, 100% { transform: translate(0, 0) rotate(0deg); }
      33% { transform: translate(30px, -30px) rotate(120deg); }
      66% { transform: translate(-20px, 20px) rotate(240deg); }
    }
    
    /* Grid background */
    body::after {
      content: '';
      position: fixed;
      inset: 0;
      background-image: 
        linear-gradient(rgba(168, 85, 247, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(168, 85, 247, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
      pointer-events: none;
      z-index: 0;
    }
    
    .container {
      position: relative;
      z-index: 10;
      max-width: 1400px;
      margin: 0 auto;
      padding: 40px 0;
    }
    
    /* Header */
    .header {
      text-align: center;
      margin-bottom: 48px;
      animation: fadeInDown 0.8s ease-out;
    }
    
    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .icon-large {
      display: inline-block;
      width: 90px;
      height: 90px;
      background: linear-gradient(135deg, #a855f7, #ec4899);
      border-radius: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3rem;
      margin: 0 auto 24px;
      box-shadow: 0 0 60px rgba(168, 85, 247, 0.5);
      animation: logoFloat 3s ease-in-out infinite;
    }
    
    @keyframes logoFloat {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-15px); }
    }
    
    .header h1 {
      font-size: 3rem;
      font-weight: 700;
      color: white;
      margin-bottom: 12px;
      letter-spacing: -0.02em;
    }
    
    .header p {
      color: #c4b5fd;
      font-size: 1.125rem;
    }
    
    /* Graph Container */
    .graph-container {
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 24px;
      padding: 24px;
      box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      animation: fadeInUp 0.8s ease-out both;
      overflow: hidden;
    }
    
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    svg {
      width: 100%;
      height: 70vh;
      border-radius: 16px;
      background: rgba(0, 0, 0, 0.1);
    }
    
    text {
      pointer-events: none;
      user-select: none;
      font-family: 'Space Grotesk', sans-serif;
      font-weight: 500;
    }
    
    /* Footer Hint */
    .footer {
      text-align: center;
      margin-top: 24px;
      color: #a78bfa;
      font-size: 0.9rem;
      animation: fadeIn 1s ease-out 0.4s both;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .header h1 {
        font-size: 2.25rem;
      }
      
      svg {
        height: 60vh;
      }
    }
  </style>

  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>
  <div class="container">
    
    <!-- Header -->
    <div class="header">
      <div class="icon-large">ðŸ§ </div>
      <h1>OS Knowledge Graph</h1>
      <p>Explore Operating System topics in any order</p>
    </div>

    <!-- Graph Container -->
    <div class="graph-container">
      <svg id="graph"></svg>
    </div>

    <!-- Footer -->
    <div class="footer">
      <p>Drag nodes freely â€¢ Independent topics can be learned anytime</p>
    </div>

  </div>

  {{ nodes|json_script:"nodes-data" }}
  {{ links|json_script:"links-data" }}

  <script>
  const nodes = JSON.parse(
    document.getElementById("nodes-data").textContent
  );

  const links = JSON.parse(
    document.getElementById("links-data").textContent
  );

  const svg = d3.select("#graph");
  const width = svg.node().clientWidth;
  const height = svg.node().clientHeight;

  const independentNodes = nodes.filter(d => d.independent);
  const coreNodes = nodes.filter(d => !d.independent);

  const simulation = d3.forceSimulation(nodes)
    .force("link",
      d3.forceLink(links)
        .id(d => d.id)
        .distance(140)
        .strength(0.8)
    )
    .force("charge",
      d3.forceManyBody()
        .strength(d => d.independent ? -120 : -300)
    )
    .force("collision",
      d3.forceCollide()
        .radius(55)
        .strength(1)
    )
    .force("coreX",
      d3.forceX(d => d.independent ? width * 0.85 : width * 0.35)
        .strength(0.25)
    )
    .force("coreY",
      d3.forceY(d => {
        if (d.independent) {
          return 120 + independentNodes.indexOf(d) * 90;
        }
        return height / 2;
      }).strength(0.25)
    );

  const link = svg.append("g")
    .attr("stroke", "#9ca3af")
    .attr("stroke-dasharray", "5,5")
    .selectAll("line")
    .data(links)
    .enter()
    .append("line");

  const node = svg.append("g")
    .selectAll(".node")
    .data(nodes)
    .enter()
    .append("g")
    .call(
      d3.drag()
        .on("start", dragstarted)
        .on("drag", dragged)
        .on("end", dragended)
    );

  node.append("circle")
    .attr("r", 22)
    .attr("fill", d => d.independent ? "#22c55e" : "#f59e0b")
    .attr("stroke", "#fff")
    .attr("stroke-width", 2);

  node.append("text")
    .text(d => d.id)
    .attr("y", 38)
    .attr("text-anchor", "middle")
    .attr("font-size", "12px")
    .attr("fill", "#e9d5ff");

  simulation.on("tick", () => {
    link
      .attr("x1", d => d.source.x)
      .attr("y1", d => d.source.y)
      .attr("x2", d => d.target.x)
      .attr("y2", d => d.target.y);

    node
      .attr("transform", d => `translate(${d.x}, ${d.y})`);
  });

  function dragstarted(event, d) {
    if (!event.active) simulation.alphaTarget(0.3).restart();
    d.fx = d.x;
    d.fy = d.y;
  }

  function dragged(event, d) {
    d.fx = event.x;
    d.fy = event.y;
  }

  function dragended(event, d) {
    if (!event.active) simulation.alphaTarget(0);
    d.fx = null;
    d.fy = null;
  }
  </script>

</body>
</html>